Local Makineye Kubernetes Cluster Kurulumu

Minikube iÃ§in de bilgisayarÄ±nÄ±zda bir sanallaÅŸtÄ±rma yazÄ±lÄ±mÄ± olmasÄ± gerekiyor.
macOS: VirtualBox or VMware Fusion, or HyperKit.
Linux: VirtualBox or KVM.
Windows: VirtualBox or Hyper-V.
  
Minikube Kurulumu  
https://minikube.sigs.k8s.io/docs/start/
  
$minikube version
$minikube start


kubectl komutumuzu kullanarak kubernetes clusterâ€™Ä±mÄ±zÄ± yÃ¶netmeye baÅŸlayabiliriz.
$kubectl get nodes
$minikube dashboard --url   or minikube dashboard

Ã¶rnek pod oluÅŸturalÄ±m.
kubectl create deployment hello-node --image=gcr.io/hello-minikube-zero-install/hello-node
kubectl get deployments

portu expose ediyoruz.
$kubectl expose deployment hello-node --type=LoadBalancer --port=8080

OluÅŸturduÄŸumuz service de expose portunu gÃ¶rebilmemiz iÃ§in ;

$kubectl get services
NAME         TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
hello-node   LoadBalancer   10.102.193.122   <pending>     8080:31789/TCP   12s
kubernetes   ClusterIP      10.96.0.1        <none>        443/TCP          29m

VirtualBox Ã¼zerinde Ã§alÄ±ÅŸan sanal makinemizin ipsini Ã¶ÄŸrendikten sonra 31789 portuna giderek Hello World Ã§Ä±ktÄ±sÄ±nÄ± gÃ¶rebiliriz.

Yada daha kolay bir ÅŸekilde; 

$minikube service hello-node

yazarak direk bizi Ã§Ä±ktÄ±ya yÃ¶nlendirir.

|-----------|------------|-------------|-----------------------------|
| NAMESPACE |    NAME    | TARGET PORT |             URL             |
|-----------|------------|-------------|-----------------------------|
| default   | hello-node |             | http://192.168.99.100:31789 |
|-----------|------------|-------------|-----------------------------|
ğŸ‰  Opening service default/hello-node in default browser...




Bir Ã¶rnek yaml dosyasÄ± ile pod yaratalÄ±m.

vim pod.yaml (https://yamlchecker.com/)

apiVersion: v1
kind: Pod
metadata:
  labels:
    run: kuard
    name: kuard
    internalVersion: 0.0.2
  name: kuard
spec:
  containers:
  - image: gcr.io/kuar-demo/kuard-amd64:1
    imagePullPolicy: IfNotPresent
    name: kuard
    ports:
    - containerPort: 8080
      name: http
      protocol: TCP
    resources: {}
  dnsPolicy: ClusterFirst  restartPolicy:Never


Kind : TÃ¼r demek , yani kubernetese ne Ã§eÅŸit bir deployment yapacaÄŸÄ±mÄ±zÄ± gÃ¶sterir. Ben poda deployment yapacaÄŸÄ±m iÃ§in kindâ€™a pod yazdÄ±m.

Name : Kuberneteste uygulamamÄ±za vereceÄŸimiz isim.

Label : Label kubernetese yapacaÄŸÄ±mÄ±z deploymentlara bir Ã§eÅŸit tag atmak demek.

Spec â€“ Containers â€“ Name : AyaÄŸa kaldÄ±rÄ±lacak ContainerÄ±n ismi

Image :  Docker Hubdan veya lokal registeryden Ã§ekiceÄŸimiz imageâ€™Ä±n ismi

Container Port :  Containerâ€™a verilen port. (Expose edilmediÄŸi sÃ¼rece dÄ±ÅŸarÄ±dan ulaÅŸÄ±lamaz)


$kubectl get pod,svc -n kube-system

NAME                                   READY   STATUS    RESTARTS   AGE
pod/coredns-5644d7b6d9-849sc           1/1     Running   0          141m
pod/coredns-5644d7b6d9-stngj           1/1     Running   0          141m
pod/etcd-minikube                      1/1     Running   0          140m
pod/kube-addon-manager-minikube        1/1     Running   0          141m
pod/kube-apiserver-minikube            1/1     Running   0          140m
pod/kube-controller-manager-minikube   1/1     Running   0          140m
pod/kube-proxy-mzhdm                   1/1     Running   0          141m
pod/kube-scheduler-minikube            1/1     Running   0          139m
pod/storage-provisioner                1/1     Running   0          141m

NAME               TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)                  AGE
service/kube-dns   ClusterIP   10.96.0.10   <none>        53/UDP,53/TCP,9153/TCP   141m


minikube addons list
minikube addons enable metrics-server
minikube addons enable heapster

Daha sonra clusterâ€™daki bÃ¼tÃ¼n podlarÄ±n CPU ve RAM kaynak tÃ¼ketimleri iÃ§in;
 kubectl top pod --all-namespaces
